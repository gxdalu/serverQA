#!/usr/bin/python
#coding=utf-8

import cookielib
import urllib
import urllib2
import json 

app_list_info = []
plugin_list_info = []

url = 'http://sweng1.mobi.zzbc.qihoo.net:2066/mod_rankapp/PluginProcess'

cookiejar = cookielib.CookieJar()
urlOpener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookiejar))

params = {
    "query_count": "10", 
    "combo": "commercial", 
    "mid": "954eb65a771f4a7e18d2ee1199bc04ab", 
    "ip": "10.18.175.49", 
    "client_version": "6.5.0",
	"query":"eyJvcyI6ImFuZHJvaWQiLCJtb2RlbCI6IlNFMGdUazlVUlNBeFRGUkZWRVE9Iiwib3N2IjoiNC40LjIiLCJtYWtlciI6IldHbGhiMjFwIiwic3ViX3BhZ2VfaWQiOiIxIiwibmV0IjoiNCIsInF1ZXJ5X2luZm8iOnsiY29udGVudCI6IiIsImtleXdvcmQiOiIiLCJtMiI6IjVhNDRlNzczNWJlZGNkODFjOTQyMjlhMzIzODdiOGFmIiwiZGV2aWNldHlwZSI6IjEiLCJydCI6IjEiLCJleHRyYV9pbmZvIjp7InJlbGF0ZWRfbmV3c19yZWxfcG9zIjowLCJyZWxhdGVkX25ld3Nfc2VyIjowLCJyZWxhdGVkX25ld3NfdXJsIjoiaHR0cCUzQSUyRiUyRm0ubmV3cy5oYW9zb3UuY29tJTJGdHJhbnNjb2RpbmclM0Z1cmwlM0RodHRwJTI1M0ElMjUyRiUyNTJGbmV3cy4xNjMuY29tJTI1MkYxNiUyNTJGMDEyMiUyNTJGMDglMjUyRkJEVFZIVEFRMDAwMTRSTzguaHRtbCIsInJlbGF0ZWRfbmV3c19yZWZlciI6Imxpc3QifSwic29mdGlkIjoiIiwia3d0eXBlIjoiIn0sImV4dHMiOnsiZXh0cmFfaW5mbyI6eyJyZWxhdGVkX25ld3NfcmVsX3BvcyI6MCwicmVsYXRlZF9uZXdzX3NlciI6MCwicmVsYXRlZF9uZXdzX3VybCI6Imh0dHAlM0ElMkYlMkZtLm5ld3MuaGFvc291LmNvbSUyRnRyYW5zY29kaW5nJTNGdXJsJTNEaHR0cCUyNTNBJTI1MkYlMjUyRm5ld3MuMTYzLmNvbSUyNTJGMTYlMjUyRjAxMjIlMjUyRjA4JTI1MkZCRFRWSFRBUTAwMDE0Uk84Lmh0bWwiLCJyZWxhdGVkX25ld3NfcmVmZXIiOiJsaXN0In19LCJhY3Rpb24iOiIwIiwicGFnZV9pZCI6IjEiLCJwbHVnaW5fdmVyIjoxMjksImNhcnJpZXIiOiI0IiwiY2hhbm5lbCI6Ii0xIiwicGx1Z2luLWluZm8iOltdLCJpbnN0YWxsZWQtYXBwIjpbeyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLm1pdWkuYmFyY29kZXNjYW5uZXIiLCJ2ZXJzaW9uIjoiNC40LjItS0hJQ05CSDE0LjAifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC5jYWxlbmRhciIsInZlcnNpb24iOiIxLjAuMSJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5hbmRyb2lkLmNhbWVyYSIsInZlcnNpb24iOiIxIn0seyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLmFuZHJvaWQuY29udGFjdHMiLCJ2ZXJzaW9uIjoiNC40LjItS0hJQ05CSDE0LjAifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC5jb250YWN0cyIsInZlcnNpb24iOiI0LjQuMi1LSElDTkJIMTQuMCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5taXVpLmdhbGxlcnkiLCJ2ZXJzaW9uIjoiMS4wLjAifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC5tbXMiLCJ2ZXJzaW9uIjoiNC40LjItS0hJQ05CSDE0LjAifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC5zZXR0aW5ncyIsInZlcnNpb24iOiI0LjQuMi1LSElDTkJIMTQuMCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5hbmRyb2lkLmJyb3dzZXIiLCJ2ZXJzaW9uIjoiMi4wLjEifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC5jYWxjdWxhdG9yMiIsInZlcnNpb24iOiI0LjQuMi1LSElDTkJIMTQuMCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5hbmRyb2lkLmRlc2tjbG9jayIsInZlcnNpb24iOiIyLjAuNCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5hbmRyb2lkLmVtYWlsIiwidmVyc2lvbiI6IuWwj+exs+WGhee9rueJiF8yMDE0MDgwMV9iOCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5hbmRyb2lkLmZpbGVleHBsb3JlciIsInZlcnNpb24iOiIwLjEuMyJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5hbmRyb2lkLnRoZW1lbWFuYWdlciIsInZlcnNpb24iOiIwLjgifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20ubWl1aS53ZWF0aGVyMiIsInZlcnNpb24iOiI0LjAuMzAifSx7InN5c3RlbV9hcHAiOjAsInBrZ25hbWUiOiJjb20udGVuY2VudC5wYiIsInZlcnNpb24iOiIzLjAifSx7InN5c3RlbV9hcHAiOjAsInBrZ25hbWUiOiJjb20uZGlhbnBpbmcudjEiLCJ2ZXJzaW9uIjoiNy44LjEifSx7InN5c3RlbV9hcHAiOjAsInBrZ25hbWUiOiJjb20ucWlob28uYXBwc3RvcmUiLCJ2ZXJzaW9uIjoiNS4wLjgwIn0seyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLmFuZHJvaWQuc3lzdGVtdWkiLCJ2ZXJzaW9uIjoiNC40LjItS0hJQ05CSDE0LjAifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20ubWl1aS5wbGF5ZXIiLCJ2ZXJzaW9uIjoiNC40LjItS0hJQ05CSDE0LjAifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC5zZXR0aW5ncyIsInZlcnNpb24iOiI0LjQuMi1LSElDTkJIMTQuMCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5taXVpLmJ1Z3JlcG9ydCIsInZlcnNpb24iOiI0LjQuMi1LSElDTkJIMTQuMCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS5hbmRyb2lkLnByb3ZpZGVycy5kb3dubG9hZHMudWkiLCJ2ZXJzaW9uIjoiNC40LjItS0hJQ05CSDE0LjAifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20ubWl1aS5mbXJhZGlvIiwidmVyc2lvbiI6IjQuNC4yLUtISUNOQkgxNC4wIn0seyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLm1pdWkuY29tcGFzcyIsInZlcnNpb24iOiIxLjYifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20ubWl1aS52aWRlbyIsInZlcnNpb24iOiI0LjguMTMifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20ubWl1aS5ub3RlcyIsInZlcnNpb24iOiI0LjQuMi1LSElDTkJIMTQuMCJ9LHsic3lzdGVtX2FwcCI6MSwicGtnbmFtZSI6ImNvbS54aWFvbWkubzJvIiwidmVyc2lvbiI6IjEuMS4xOTYifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC5zb3VuZHJlY29yZGVyIiwidmVyc2lvbiI6IjQuNC4yLUtISUNOQkgxNC4wIn0seyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLnhpYW9taS5tYXJrZXQiLCJ2ZXJzaW9uIjoiMS4yLjQifSx7InN5c3RlbV9hcHAiOjEsInBrZ25hbWUiOiJjb20uYW5kcm9pZC51cGRhdGVyIiwidmVyc2lvbiI6IjIuMi4xIn0seyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLm1pdWkudm9pY2Vhc3Npc3QiLCJ2ZXJzaW9uIjoiMS43In0seyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLnhpYW9taS54bXNmIiwidmVyc2lvbiI6IjQuNC4yLUtISUNOQkgxNC4wIn0seyJzeXN0ZW1fYXBwIjoxLCJwa2duYW1lIjoiY29tLnhpYW9taS5nYW1lY2VudGVyIiwidmVyc2lvbiI6IjIuMC4wOCJ9LHsic3lzdGVtX2FwcCI6MCwicGtnbmFtZSI6ImNvbS5hdXRvbmF2aS5taW5pbWFwIiwidmVyc2lvbiI6IjcuMS4wLjUzNiJ9LHsic3lzdGVtX2FwcCI6MCwicGtnbmFtZSI6ImNvbS5uaWxoY2VtLmhvc3RzZWRpdG9yIiwidmVyc2lvbiI6IjEuNCJ9LHsic3lzdGVtX2FwcCI6MCwicGtnbmFtZSI6ImNvbS50ZW5jZW50Lm10dCIsInZlcnNpb24iOiI2LjQuMS4yMDU1In0seyJzeXN0ZW1fYXBwIjowLCJwa2duYW1lIjoiY29tLndoYXRzYXBwIiwidmVyc2lvbiI6IjIuMTIuMzY0In0seyJzeXN0ZW1fYXBwIjowLCJwa2duYW1lIjoiY29tLnFpaG9vLnBlcm1tZ3IiLCJ2ZXJzaW9uIjoiNy4xLjIifSx7InN5c3RlbV9hcHAiOjAsInBrZ25hbWUiOiJjb20udGVuY2VudC5tbSIsInZlcnNpb24iOiI2LjIuNS41M19yMjU2NWYxOCJ9LHsic3lzdGVtX2FwcCI6MCwicGtnbmFtZSI6ImNvbS5xaWhvbzM2MC5uZXdzIiwidmVyc2lvbiI6IjEuMCJ9LHsic3lzdGVtX2FwcCI6MCwicGtnbmFtZSI6ImNvbS5kZXNhcnJvbGxvZHJvaWRlLnJlcG9zIiwidmVyc2lvbiI6IjMuNDMifSx7InN5c3RlbV9hcHAiOjAsInBrZ25hbWUiOiJjb20udWxmZGl0dG1lci5hbmRyb2lkLnBpbmciLCJ2ZXJzaW9uIjoiMi4xLjQifSx7InN5c3RlbV9hcHAiOjAsInBrZ25hbWUiOiJjb20uc2R1LmRpZGkucHNuZ2VyIiwidmVyc2lvbiI6IjQuMS4yIn0seyJzeXN0ZW1fYXBwIjowLCJwa2duYW1lIjoiY29tLnVuaWNvbS5ndWRvbmcuY2xpZW50IiwidmVyc2lvbiI6IjMuOSJ9LHsic3lzdGVtX2FwcCI6MCwicGtnbmFtZSI6ImNvbS5lZy5hbmRyb2lkLkFsaXBheUdwaG9uZSIsInZlcnNpb24iOiI5LjUuMS4wMTEzMDIifSx7InN5c3RlbV9hcHAiOjAsInBrZ25hbWUiOiJjb20uY21iY2hpbmEuY2NkLnBsdXRvLmNtYkFjdGl2aXR5IiwidmVyc2lvbiI6IjUuMC4xIn0seyJzeXN0ZW1fYXBwIjowLCJwa2duYW1lIjoiY29tLmx2bWFuIiwidmVyc2lvbiI6IjMuMSJ9LHsic3lzdGVtX2FwcCI6MCwicGtnbmFtZSI6ImNvbS5xaWhvbzM2MC5tb2JpbGVzYWZlLmFwdWxsIiwidmVyc2lvbiI6IjEuMCJ9XX0="
}

postData = json.dumps(params)
req = urllib2.Request(url,postData)
res = urlOpener.open(req)
jsonStr = res.read()
Str = json.loads(jsonStr)

if Str.has_key('app_list'):
	app_list = Str['app_list']
	for app in app_list:
		app_info = {}
		plugin_info = {}
		cpr = app['cpr']
		if len(str(app['pkg_name'])) != 0:
			app_info['pkgname']=app['pkg_name']
			app_info['size']=cpr['size']
			app_list_info.append(app_info)
		else:
			plugin_info['app_id']=cpr['app_id']
			plugin_list_info.append(plugin_info)

print app_list_info
print plugin_list_info
